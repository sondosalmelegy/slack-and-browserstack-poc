name: Test & Notify

on:
  push:
    branches:
      - main
  pull_request:

jobs:
  run-tests:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v3

    - name: Set up Java
      uses: actions/setup-java@v3
      with:
        distribution: 'temurin'
        java-version: '24'

    - name: Run Tests on BrowserStack
      env:
        BROWSERSTACK_USERNAME: ${{ secrets.BROWSERSTACK_USERNAME }}
        BROWSERSTACK_ACCESS_KEY: ${{ secrets.BROWSERSTACK_ACCESS_KEY }}
      run: |
        echo "Running tests on BrowserStack..."
        mvn test -Dsurefire.suiteXmlFiles=path/to/testng.xml

    - name: Notify Slack
      uses: slackapi/slack-github-action@v1.26.0
      with:
        payload: |
          {
            "channel": "#general",
            "text": "âœ… BrowserStack tests finished! Check results."
          }
      env:
        SLACK_BOT_TOKEN: ${{ secrets.SLACK_BOT_TOKEN }}
